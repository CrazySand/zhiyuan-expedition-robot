# 智元远征开发环境配置

## 相关文档

- [A2 旗舰款开发指南 (v1.3)](https://open.agibot.com/docs/aimdk/a2/v1_3/dev_guide) - A2 旗舰款高层接口开发文档

## 一键安装 ROS2

```bash
wget http://fishros.com/install -O fishros && . fishros
```

## IP 地址对应关系

### 设备 IP 地址

| IP 地址 | 设备类型 | 说明 |
|---------|---------|------|
| `192.168.xxx.xxx` | x86 | 遥控器局域网 IP |
| `192.168.100.100` | x86 | x86 设备 |
| `192.168.100.110` | orin | Orin 设备 |

### 网络连接关系

- `192.168.xxx.xxx` ↔ `192.168.100.100` (双向连接)
- `192.168.xxx.xxx` → `192.168.100.110` (单向连接，只能从 `xxx.xxx` 连接到 `100.110`)
- `192.168.100.100` ↔ `192.168.100.110` (双向连接)

## 远程连接

### 1. 直接远程连接

**前提条件：**
- 查看遥控器的 WIFI 局域网 IP（x86 IP）
- 默认密码：`1`

**连接命令：**

```bash
ssh agi@192.168.1.114
```

> **注意：** 请将 `192.168.1.114` 替换为实际的遥控器局域网 IP 地址

### 2. 跳板连接 + 端口转发

通过跳板连接到 Orin，并建立端口转发。若遥控器 IP（如 `192.168.1.115`）能**直接访问** `192.168.100.110`，只需一跳：

```powershell
ssh -J agi@192.168.1.115 -L 59301:192.168.100.110:59301 -L 53176:192.168.100.110:53176 -L 50807:192.168.100.110:50807 -L 56322:192.168.100.100:56322 -L 56666:192.168.100.110:56666 -L 59888:192.168.100.110:59888 -L 51011:192.168.100.110:51011 -L 50587:192.168.100.110:50587 -L 56421:192.168.100.100:56421 -R 8001:localhost:8000 -N agi@192.168.100.110
```

若无法直连 Orin，需经 x86 再跳一层，则用两跳（将 `-J` 改为 `agi@192.168.1.115,agi@192.168.100.100`）。

**参数说明：**

- `-J agi@192.168.1.115`: 跳板机，从本机先连到遥控器，再连到末尾的 `192.168.100.110`
- `-N`: 不执行远程命令，仅维持连接做端口转发

**本地端口转发（-L）** — 本机访问远程服务：
- `-L 59301:192.168.100.110:59301`: 本地 `localhost:59301` → Orin（TTS/Agent）
- `-L 50807:192.168.100.110:50807`: 本地 `localhost:50807` → Orin（地图/定位）
- `-L 56322:192.168.100.100:56322`: 本地 `localhost:56322` → x86 `192.168.100.100:56322`（运控 McAction）
- `-L 56666:192.168.100.110:56666`: 本地 `localhost:56666` → Orin（音频）
- `-L 59888:192.168.100.110:59888`: 本地 `localhost:59888` → Orin（机器人端 FastAPI）
- `-L 51011:192.168.100.110:51011`: 本地 `localhost:51011` → Orin（系统状态 GetSystemState）
- `-L 50587:192.168.100.110:50587`: 本地 `localhost:50587` → Orin（告警列表 GetAlertList）
- `-L 56421:192.168.100.100:56421`: 本地 `localhost:56421` → x86（BMS/急停 GetBmsState、GetEmergencyState）

**远程端口转发（-R）** — 远程访问本机服务：
- `-R 8001:localhost:8000`: 在 Orin 上访问 `localhost:8001` → 本机 `localhost:8000`（PC 端 API，如 FaceID 回调）

**使用说明：**
- 执行后保持终端不关闭，端口转发才有效
- 本机可通过 `localhost:59301`、`50807`、`56322`、`56666`、`59888`、`51011`、`50587`、`56421` 访问对应服务
- 机器人端通过 `192.168.100.110:8001` 访问本机 PC API

## 注意（Orin 上的文件保留路径）

- 在 Orin 设备上，只有放在 /agibot/data/home/agi/Desktop 的文件和目录不会被系统的自动清理程序删除。请将需要长期保留的脚本、配置和数据放在该路径下，以免被定期清理。