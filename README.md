# 智元远征开发环境配置

## 相关文档

- [A2 旗舰款开发指南 (v1.3)](https://open.agibot.com/docs/aimdk/a2/v1_3/dev_guide) - A2 旗舰款高层接口开发文档

## 一键安装 ROS2

```bash
wget http://fishros.com/install -O fishros && . fishros
```

## IP 地址对应关系

### 设备 IP 地址

| IP 地址 | 设备类型 | 说明 |
|---------|---------|------|
| `192.168.xxx.xxx` | x86 | 遥控器局域网 IP |
| `192.168.100.100` | x86 | x86 设备 |
| `192.168.100.110` | orin | Orin 设备 |

### 网络连接关系

- `192.168.xxx.xxx` ↔ `192.168.100.100` (双向连接)
- `192.168.xxx.xxx` → `192.168.100.110` (单向连接，只能从 `xxx.xxx` 连接到 `100.110`)
- `192.168.100.100` ↔ `192.168.100.110` (双向连接)

## 远程连接

### 1. 直接远程连接

**前提条件：**
- 查看遥控器的 WIFI 局域网 IP（x86 IP）
- 默认密码：`1`

**连接命令：**

```bash
ssh agi@192.168.1.114
```

> **注意：** 请将 `192.168.1.114` 替换为实际的遥控器局域网 IP 地址

### 2. 多层跳板连接

通过多层跳板连接到 Orin 设备，并建立端口转发：

```powershell
ssh -J agi@192.168.1.115,agi@192.168.100.100 -L 59301:192.168.100.110:59301 -L 50807:192.168.100.110:50807 -L 56666:192.168.100.110:56666 -L 59888:192.168.100.110:59888 -R 8001:localhost:8000 -N agi@192.168.100.110
```

**参数说明：**

- `-J agi@192.168.1.115,agi@192.168.100.100`: 跳板机配置，依次通过 `192.168.1.115` 和 `192.168.100.100` 跳转
- `-N`: 不执行远程命令，仅建立连接

**本地端口转发（-L）** - 从本地访问远程服务：
- `-L 59301:192.168.100.110:59301`: 本地 `localhost:59301` → Orin `192.168.100.110:59301`（TTS/Agent 服务）
- `-L 50807:192.168.100.110:50807`: 本地 `localhost:50807` → Orin `192.168.100.110:50807`（地图/定位服务）
- `-L 56322:192.168.100.100:56322`: 本地 `localhost:56322` → **x86** `192.168.100.100:56322`（运控 McAction 服务）
- `-L 56666:192.168.100.110:56666`: 本地 `localhost:56666` → Orin `192.168.100.110:56666`（音频服务）
- `-L 59888:192.168.100.110:59888`: 本地 `localhost:59888` → Orin `192.168.100.110:59888`（机器人端 FastAPI）

**远程端口转发（-R）** - 从远程访问本地服务：
- `-R 8001:localhost:8000`: 远程访问 `192.168.100.110:8001` → 转发到本地 `localhost:8000`（PC 端 API 服务）

**使用说明：**
- 执行此命令后，保持终端窗口运行，端口转发才会生效
- 本地可通过 `localhost:59301`、`localhost:50807`、`localhost:56322`、`localhost:56666`、`localhost:59888` 访问对应远程服务
- 远程机器人可通过 `192.168.100.110:8001` 访问本地 PC 端 API 服务（如 FaceID 回调）

## 注意（Orin 上的文件保留路径）

- 在 Orin 设备上，只有放在 /agibot/data/home/agi/Desktop 的文件和目录不会被系统的自动清理程序删除。请将需要长期保留的脚本、配置和数据放在该路径下，以免被定期清理。